from random import shuffle   # randomize order of the list
from os import system, name   # used to clear the screen based on the operating system

# define the suits, ranks and their values

SUITS=("Hearts", "Diamonds","Spades","Clubs")
RANKS=( "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten",
    "Jack", "Queen", "King", "Ace")
VALUES={"Two":2,"Three":3, "Four":4, "Five":5, "Six":6, "Seven":7, "Eight":8, "Nine":9, "Ten":10,
    "Jack":10, "Queen":10, "King":10, "Ace":11}






class Card:
    # represent a single card with suit and rank
    def __init__(self,suit,rank):
        self.suit=suit
        self.rank=rank
       
    def __str__(self):     # return a string representation of the card
        return f"{self.rank} of {self.suit}"    
    
    
    
    

class Deck:
    # represent a deck of 52 automatically shuffled cards
    def __init__(self):
        self.deck=[Card(suit,rank) for suit in SUITS for rank in RANKS]
        shuffle(self.deck)   # shuffle deck to ensure randomness      
    def deal_card(self):   # returns a single card from the deck
        return self.deck.pop()    
    
    
    
    
       
class Hand:
    # represent a player's or dealer's hand
    # track value in the hand and how many aces are in it
    def __init__(self):
        self.cards=[]
        self.value=0
        self.num_of_aces=0
    def add_card(self,card):
        # add card to the hand and updates the hand total value and adjusting aces
        self.cards.append(card)
        self.value+=VALUES[card.rank]
        if card.rank=="Ace":
            self.num_of_aces+=1
        self.adjust_aces() 
        # adjust ace value if hand exceeds 21 and handling it 
    def adjust_aces(self):   
        ''' If the value of the hand exceeds 21 and there are Aces counted as 11,
        convert them to 1 by subtracting 10 from the total'''

        while self.num_of_aces>0 and self.value>21:
            self.value-=10
            self.num_of_aces-=1
            
            
            
            
                    
class Bets:
    # manage player's betting money
    def __init__(self):
        self.total=100
        self.bet=0
    def win_bet(self): # increase total money by the current bet amount
        self.total+=self.bet
    def lose_bet(self):   # decrease total money by the current bet amount
          self.total-=self.bet      
          
          
          

def take_bet(player_bet):
    while True:
        try:
            user_bet=int(input(f"Enter your bet ( Available: {player_bet.total})"))
            if 0<user_bet<= player_bet.total:
                player_bet.bet=user_bet
                return
            else:
                print("Invalid bet amount.. Try again.")
        except ValueError:
            print("Please enter a valid integer")  
                  
                  
                  
                
def display_hand(name,hand,hide_first=False):
    print(f"\n{name}'s Hand" , end=" ")
    if hide_first:
        print(f"[Hidden card]", ", ".join(str(card) for card in hand.cards[1:] ) )
    else:
            print( ", ".join(str(card) for card in hand.cards) , f" (value: {hand.value})" )
            
            
            
            
         
         
def check_blackjack(hand):
    return len(hand.cards)==2 and hand.value==21



def hit (deck , hand):
    hand.add_card(deck.deal_card())
    
    
def player_turn(deck,player_hand,player_bet):
    while player_hand.value<21:
        choice=input("[HIT | STAND]").lower()
        if choice == "hit":
             hit(deck,player_hand)
             display_hand("player",player_hand)
        elif choice=="stand":
            break
        else:
            print("Invalid choice, type 'HIT' or 'STAND'")
            
            
            

def dealer_turn(deck,dealer_hand)  :
    while dealer_hand.value<17:
        hit(deck,dealer_hand)
    display_hand("dealer",dealer_hand)                   
             
        
        
        
        
def selecting_winner(player_hand, dealer_hand,player_bet):
    if player_hand.value>21:
        print("player busts! dealer wins!")
        player_bet.lose_bet()
    elif dealer_hand.value>21 or player_hand.value>dealer_hand.value:
         print("player win!")
         player_bet.win_bet()
    elif player_hand.value<dealer_hand.value:
        print("dealer wins!")
        player_bet.lose_bet()
    else:
         print("it's a tie!")
            



               
                
def play_blackjack():
    print("WELCOME TO BLACKJACK!")
    player_bet=Bets()
    while player_bet.total>0:
        deck=Deck()
        player_hand=Hand()
        dealer_hand=Hand()
        take_bet(player_bet)
        for _ in range(2):
            player_hand.add_card(deck.deal_card())
            dealer_hand.add_card(deck.deal_card())
        display_hand("player",player_hand)
        display_hand("dealer",dealer_hand,hide_first=True) 
        if check_blackjack(player_hand):
            print("BLACKJACK! PLAYER WINS!")
            player_bet.win_bet()
        else:
            player_turn(deck,player_hand,player_bet) 
            if player_hand.value>21:
                display_hand("dealer",dealer_hand)
                selecting_winner(player_hand,dealer_hand,player_bet)
            else:
                    print("dealer's turn..")
                    dealer_turn(deck,dealer_hand) 
                    selecting_winner(player_hand,dealer_hand,player_bet)
            
        print(f"player's money: {player_bet.total}")   
        if player_bet.total==0:
            print("out of money! GAME OVER")
            break
        again=input("\nPlay again?  (Y/N)").lower()
        if again == 'n':
            break
        system("cls" if name == "nt" else "clear")  # Clear screen based on the operating system
        
        
play_blackjack()            
             
                     
                                      
